<div class="auth-container">
  <div class="auth-split">
    <div class="auth-brand">
      <div class="brand-content">
        <h1>MeetingApp</h1>
        <p>Toplantılarınızı kolayca yönetin</p>
      </div>
    </div>

    <div class="auth-form">
      <div class="form-container">
        <div class="auth-header">
          <h2>Hesap Oluştur</h2>
          <p>Yeni bir hesap oluşturun</p>
        </div>

        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <div class="profile-upload">
        <div class="avatar-preview">
          @if (previewUrl()) {
            <img [src]="previewUrl()" alt="Preview">
            <div class="avatar-actions">
              <button type="button" class="avatar-action-btn change" (click)="fileInput.click()" title="Değiştir">
                <app-icon name="edit" [size]="16" />
              </button>
              <button type="button" class="avatar-action-btn delete" (click)="removePhoto()" title="Sil">
                <app-icon name="trash" [size]="16" />
              </button>
            </div>
          } @else {
            <div class="placeholder" (click)="fileInput.click()">
              <app-icon name="user" [size]="48" />
              <p>Profil Fotoğrafı Seç</p>
            </div>
          }
        </div>
        <input 
          #fileInput
          type="file" 
          (change)="onFileSelect($event)"
          accept="image/*"
          hidden
        >
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="firstName">Ad</label>
          <input 
            id="firstName"
            type="text" 
            formControlName="firstName"
            placeholder="Adınız"
            [class.is-invalid]="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched"
          >
          @if (registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched) {
            <span class="error-message">
              {{ getError('firstName') }}
            </span>
          }
        </div>

        <div class="form-group">
          <label for="lastName">Soyad</label>
          <input 
            id="lastName"
            type="text" 
            formControlName="lastName"
            placeholder="Soyadınız"
            [class.is-invalid]="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched"
          >
          @if (registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched) {
            <span class="error-message">
              {{ getError('lastName') }}
            </span>
          }
        </div>
      </div>

      <div class="form-group">
        <label for="email">Email</label>
        <input 
          id="email"
          type="email" 
          formControlName="email"
          placeholder="ornek@email.com"
          [class.is-invalid]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched"
        >
        @if (registerForm.get('email')?.invalid && registerForm.get('email')?.touched) {
          <span class="error-message">
            {{ getError('email') }}
          </span>
        }
      </div>

      <div class="form-group">
        <label for="phone">Telefon</label>
        <ngx-intl-tel-input
          [cssClass]="'custom-tel-input'"
          [preferredCountries]="preferredCountries"
          [enableAutoCountrySelect]="true"
          [enablePlaceholder]="true"
          [searchCountryFlag]="true"
          [searchCountryField]="[SearchCountryField.Name, SearchCountryField.DialCode]"
          [selectFirstCountry]="false"
          [selectedCountryISO]="CountryISO.Turkey"
          [maxLength]="15"
          [phoneValidation]="true"
          [separateDialCode]="true"
          formControlName="phone"
          [class.is-invalid]="registerForm.get('phone')?.invalid && registerForm.get('phone')?.touched">
        </ngx-intl-tel-input>
        @if (registerForm.get('phone')?.invalid && registerForm.get('phone')?.touched) {
          <span class="error-message">
            {{ getError('phone') }}
          </span>
        }
      </div>

      <div class="form-group">
        <label for="password">Şifre</label>
        <input 
          id="password"
          type="password" 
          formControlName="password"
          placeholder="••••••••"
          [class.is-invalid]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched"
        >
        @if (registerForm.get('password')?.invalid && registerForm.get('password')?.touched) {
          <span class="error-message">
            {{ getError('password') }}
          </span>
        }
      </div>

      @if (errorMessage()) {
        <div class="error-box">
          {{ errorMessage() }}
        </div>
      }

      <button type="submit" class="btn btn-primary btn-block" [disabled]="loading()">
        @if (!loading()) {
          <span>Kayıt Ol</span>
        } @else {
          <span class="spinner"></span>
        }
      </button>
    </form>

        <div class="auth-footer">
          <p>Zaten hesabınız var mı? <a routerLink="/auth/login">Giriş Yap</a></p>
        </div>
      </div>
    </div>
  </div>
</div>